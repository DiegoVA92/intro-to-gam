<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Why GAM? | Workshop: Introduction to GAM</title>
  <meta name="description" content="An introduction to GAM given as a workshop to the Journal Club UNALM community" />
  <meta name="generator" content="bookdown 0.22.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Why GAM? | Workshop: Introduction to GAM" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to GAM given as a workshop to the Journal Club UNALM community" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Why GAM? | Workshop: Introduction to GAM" />
  
  <meta name="twitter:description" content="An introduction to GAM given as a workshop to the Journal Club UNALM community" />
  

<meta name="author" content="Diego Villa" />


<meta name="date" content="2021-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="literature.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to GAM</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-little-about-me"><i class="fa fa-check"></i>A little about me</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>1</b> Why GAM?</a></li>
<li class="chapter" data-level="2" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>2</b> Literature</a></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Methods</a></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a>
<ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop: Introduction to GAM</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="why" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Why GAM?</h1>
<p>The task of a supervised statistical learning model is to approximate the ground truth function that governs the statistical association between a response variable, denoted by <span class="math inline">\(Y\)</span>, and one or more predictor variables, denoted by <span class="math inline">\(X\)</span>. Say the ground truth model is <span class="math inline">\(Y = f(X) + \epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span> is a random error. Therefore, we want to find an estimate of the function <span class="math inline">\(f(X)\)</span>, denoted by <span class="math inline">\(\hat{f}(X)\)</span>, such that we can use it to predict or infer about the response <span class="math inline">\(Y\)</span>.</p>
<p>Let’s see an example. <span class="citation"><a href="#ref-lathrop2013madison" role="doc-biblioref">Lathrop</a> (<a href="#ref-lathrop2013madison" role="doc-biblioref">2013</a>)</span> directed a long-term sampling program, from 1976 to 1994, on the population of zooplankton at the four Yahara River chain of lakes (Mendota, Monona, Waubesa, and Kegonsa) in the state of Wisconsin, USA. <span class="citation"><a href="#ref-pedersen2019hierarchical" role="doc-biblioref">Pedersen et al.</a> (<a href="#ref-pedersen2019hierarchical" role="doc-biblioref">2019</a>)</span> analyzed a processed version of this data using Hierarchical Generalized Additive Models (HGAM) (Don’t worry about <em>hierarchical</em> yet). We are going to reproduce this analysis to show the main concepts about GAM.</p>
<p>The data set consist on measurements of the population density of 8 zooplankton taxa in the aforementioned lakes taken roughly in a biweekly schedule, although, depending on the season or weather conditions, the sampling frequency varied. The day of the week of the measurement was recorded, as well as the year. Our aim is to build a model to infer population density of a taxon at a certain day of the year in the Mendota lake. Accordingly, the population density is our response variable, and the taxon and the day of the year are our predictor variables.</p>
<p>First, let’s keep things simple and analyze the association between the population density and the day of the year for a particular taxon in lake Mendota. The sample distribution of the population density is very right skewed to zero. This tells us for instance that a normality assumption may not be appropiate. We are going to follow this preliminary analysis by using the population density in the logarithmic scale. Let’s select the <em>D. thomasi</em> taxon and build a scatterplot with the days of year.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="why.html#cb1-1" aria-hidden="true" tabindex="-1"></a>plt_thomasi <span class="ot">&lt;-</span> </span>
<span id="cb1-2"><a href="why.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  zooplankton <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="why.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(taxon <span class="sc">==</span> <span class="st">&quot;D. thomasi&quot;</span>, lake <span class="sc">==</span> <span class="st">&quot;Mendota&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="why.html#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> <span class="fu">log</span>(density_adj))) <span class="sc">+</span></span>
<span id="cb1-5"><a href="why.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-6"><a href="why.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Day of year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Adj. population density (log scale)&quot;</span>) </span>
<span id="cb1-7"><a href="why.html#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="why.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_thomasi)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-simple"></span>
<img src="intro-to-gam_files/figure-html/scatter-simple-1.png" alt="Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake." width="672" />
<p class="caption">
Figure 1.1: Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake.
</p>
</div>
<p>In Figure <a href="why.html#fig:scatter-simple">1.1</a> we can distinguish a pattern in the population density throughout the days, but it is clearly kind of difficult to tell its form. One thing is for sure, it isn’t a linear association. Consequently, a linear regression model would be inadequate. A common approach is to fit a local regression curve or LOESS (locally estimated scatterplot smoothing) to have a sense of the form of the association. Let’s plot both a linear regression line and a LOESS to compare.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="why.html#cb2-1" aria-hidden="true" tabindex="-1"></a>plt_thomasi_lm <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="why.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  plt_thomasi <span class="sc">+</span></span>
<span id="cb2-3"><a href="why.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;lm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="why.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;LOESS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="why.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#E64B35B2&quot;</span>, <span class="st">&quot;#4DBBD5B2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="why.html#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;Method&quot;</span>) </span>
<span id="cb2-7"><a href="why.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="why.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_thomasi_lm)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-lm"></span>
<img src="intro-to-gam_files/figure-html/scatter-lm-1.png" alt="Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake showing the linear regression fitted line and the LOESS fitted curve." width="672" />
<p class="caption">
Figure 1.2: Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake showing the linear regression fitted line and the LOESS fitted curve.
</p>
</div>
<p>From From <a href="why.html#fig:scatter-lm">1.2</a> we can check that the linear regression line definitely does not capture the association of the population density and the days of the year. On the other hand, the LOESS curve appears to better capture the pattern. However, this method is a non-parametric memory-based approach design for plotting purposes, and it does not help us much to do inferences as it does not outputs an equation or fitted parameters to work with.</p>
<p>As we stated in the initial paragraph, we need to find a function <span class="math inline">\(\hat{f}(X)\)</span> to be able to predict the response variable. But, how do we specify this function so it accurately capture the association between the variables? For instance, the linear regression model assumes that the form of the function <span class="math inline">\(\hat{f}(X)\)</span> es linear in the regression coefficients. That is, it assumes a linear association between the response variable and the predictors (or transformations of the predictors). This is a very restrictive form, but certainly very useful in a variety of applications. However, we now for sure it won’t be useful for our analysis. We could try polynomial regression. Let’s plot a second degree and a third degree polynomial, together with the LOESS curve.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="why.html#cb3-1" aria-hidden="true" tabindex="-1"></a>plt_thomasi_poly <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="why.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  plt_thomasi <span class="sc">+</span></span>
<span id="cb3-3"><a href="why.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-4"><a href="why.html#cb3-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;poly(2)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-5"><a href="why.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-6"><a href="why.html#cb3-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;poly(3)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-7"><a href="why.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;LOESS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-8"><a href="why.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#4DBBD5B2&quot;</span>, <span class="st">&quot;#00A087B2&quot;</span>, <span class="st">&quot;#8491B4B2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="why.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;Method&quot;</span>)</span>
<span id="cb3-10"><a href="why.html#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="why.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_thomasi_poly)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-poly"></span>
<img src="intro-to-gam_files/figure-html/scatter-poly-1.png" alt="Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake showing second and third degree polynomial regression fitted curves and the LOESS fitted curve." width="672" />
<p class="caption">
Figure 1.3: Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake showing second and third degree polynomial regression fitted curves and the LOESS fitted curve.
</p>
</div>
<p>We see from Figure @ref{fig:scatter-poly} that the third degree polynomial offers a good fit to the data, similar to the LOESS curve. The disadvantage is that it is still a linear regression model. The only thing that changes is that the response is regressed over some transformation of the predictors, in this case, the n-th degree polynomial. This is certainly a good trick. But, what if we want to model more complex non-linear associations? We need a more flexible approach. Generalized Additive Models (GAM) allow us to build very flexible models by using smooth functions over the predictors that can take a variety of forms and structures. Let’s see them in action. We are going to add a GAM fitted curve to the plot.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="why.html#cb4-1" aria-hidden="true" tabindex="-1"></a>plt_thomasi_poly <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="why.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  plt_thomasi <span class="sc">+</span></span>
<span id="cb4-3"><a href="why.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-4"><a href="why.html#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;GAM&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="why.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-6"><a href="why.html#cb4-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;poly(2)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="why.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-8"><a href="why.html#cb4-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;poly(3)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-9"><a href="why.html#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;LOESS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-10"><a href="why.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#DC0000B2&quot;</span>, <span class="st">&quot;#4DBBD5B2&quot;</span>, <span class="st">&quot;#00A087B2&quot;</span>, </span>
<span id="cb4-11"><a href="why.html#cb4-11" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;#8491B4B2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-12"><a href="why.html#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;Method&quot;</span>)</span>
<span id="cb4-13"><a href="why.html#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="why.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_thomasi_poly)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-gam"></span>
<img src="intro-to-gam_files/figure-html/scatter-gam-1.png" alt="Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake showing second and third degree polynomial regression fitted curvesand the LOESS fitted curve." width="672" />
<p class="caption">
Figure 1.4: Scatterplot of the (log) population density and the day of the day for the D. thomasi taxon in Mendota lake showing second and third degree polynomial regression fitted curvesand the LOESS fitted curve.
</p>
</div>
<p>Before this, I guess you may be wondering why we care about this. Do we really need to specify or know the form of the function? Why we bother about this? We could just run a black-box algorithm, like a random forest, and get (mostly certainly) a good prediction accuracy on the population density.</p>
<p>Why we bother about this?</p>
<p>You can label chapter and section titles using <code>{#label}</code> after them, e.g., we can reference Chapter. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter <a href="methods.html#methods">3</a>.</p>
<p>Figures and tables with captions will be placed in <code>figure</code> and <code>table</code> environments, respectively.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="why.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>, .<span class="dv">1</span>))</span>
<span id="cb5-2"><a href="why.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pressure, <span class="at">type =</span> <span class="st">&#39;b&#39;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nice-fig"></span>
<img src="intro-to-gam_files/figure-html/nice-fig-1.png" alt="Here is a nice figure!" width="80%" />
<p class="caption">
Figure 1.5: Here is a nice figure!
</p>
</div>
<p>Reference a figure by its code chunk label with the <code>fig:</code> prefix, e.g., see Figure <a href="why.html#fig:nice-fig">1.5</a>. Similarly, you can reference tables generated from <code>knitr::kable()</code>, e.g., see Table <a href="why.html#tab:nice-tab">1.1</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="why.html#cb6-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb6-2"><a href="why.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(iris, <span class="dv">20</span>), <span class="at">caption =</span> <span class="st">&#39;Here is a nice table!&#39;</span>,</span>
<span id="cb6-3"><a href="why.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> <span class="cn">TRUE</span></span>
<span id="cb6-4"><a href="why.html#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:nice-tab">Table 1.1: </span>Here is a nice table!</caption>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.6</td>
<td align="right">3.4</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.0</td>
<td align="right">3.4</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">2.9</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.4</td>
<td align="right">3.7</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.8</td>
<td align="right">3.4</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.8</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.3</td>
<td align="right">3.0</td>
<td align="right">1.1</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.8</td>
<td align="right">4.0</td>
<td align="right">1.2</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.7</td>
<td align="right">4.4</td>
<td align="right">1.5</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.3</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.7</td>
<td align="right">3.8</td>
<td align="right">1.7</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="right">3.8</td>
<td align="right">1.5</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<p>You can write citations, too. For example, we are using the <strong>bookdown</strong> package <span class="citation">(<a href="#ref-R-bookdown" role="doc-biblioref">Xie 2021</a>)</span> in this sample book, which was built on top of R Markdown and <strong>knitr</strong> <span class="citation">(<a href="#ref-xie2015" role="doc-biblioref">Xie 2015</a>)</span>.</p>

</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lathrop2013madison" class="csl-entry">
Lathrop, Richard. 2013. <span>“Madison Wisonsin Lakes Zooplankton 1976-1994.”</span>
</div>
<div id="ref-pedersen2019hierarchical" class="csl-entry">
Pedersen, Eric J, David L Miller, Gavin L Simpson, and Noam Ross. 2019. <span>“Hierarchical Generalized Additive Models in Ecology: An Introduction with Mgcv.”</span> <em>PeerJ</em> 7: e6876.
</div>
<div id="ref-xie2015" class="csl-entry">
Xie, Yihui. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.org/knitr/">http://yihui.org/knitr/</a>.
</div>
<div id="ref-R-bookdown" class="csl-entry">
———. 2021. <em>Bookdown: Authoring Books and Technical Documents with r Markdown</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="literature.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro-to-gam.pdf", "intro-to-gam.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
