<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Introduction | Workshop: Introduction to GAMs</title>
  <meta name="description" content="An introduction to GAM given as a workshop to the Journal Club UNALM community" />
  <meta name="generator" content="bookdown 0.22.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Introduction | Workshop: Introduction to GAMs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to GAM given as a workshop to the Journal Club UNALM community" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Introduction | Workshop: Introduction to GAMs" />
  
  <meta name="twitter:description" content="An introduction to GAM given as a workshop to the Journal Club UNALM community" />
  

<meta name="author" content="Diego Villa" />


<meta name="date" content="2021-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="inter-flex.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to GAMs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-little-about-me"><i class="fa fa-check"></i>A little about me</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i>Setup</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="inter-flex.html"><a href="inter-flex.html"><i class="fa fa-check"></i><b>2</b> Interpretability vs. flexibility</a></li>
<li class="chapter" data-level="3" data-path="gams.html"><a href="gams.html"><i class="fa fa-check"></i><b>3</b> GAMs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gams.html"><a href="gams.html#def"><i class="fa fa-check"></i><b>3.1</b> Definition</a></li>
<li class="chapter" data-level="3.2" data-path="gams.html"><a href="gams.html#smooth"><i class="fa fa-check"></i><b>3.2</b> Smoothing</a></li>
<li class="chapter" data-level="3.3" data-path="gams.html"><a href="gams.html#pena"><i class="fa fa-check"></i><b>3.3</b> Penalization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="application.html"><a href="application.html"><i class="fa fa-check"></i><b>4</b> Application</a></li>
<li class="chapter" data-level="5" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>5</b> Resources</a>
<ul>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#books"><i class="fa fa-check"></i>Books</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#papers"><i class="fa fa-check"></i>Papers</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#online-courses"><i class="fa fa-check"></i>Online courses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop: Introduction to GAMs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Introduction</h1>
<p>The task of a supervised statistical learning model is to approximate the ground truth function that governs the statistical association between a response variable, denoted by <span class="math inline">\(Y\)</span>, and one or more predictor variables, denoted by <span class="math inline">\(X\)</span>. Say the ground truth model is <span class="math inline">\(Y = f(X) + \epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span> is a random error. Therefore, we want to find an estimate of the function <span class="math inline">\(f(X)\)</span>, denoted by <span class="math inline">\(\hat{f}(X)\)</span>, such that we can use it to predict or infer about the response <span class="math inline">\(Y\)</span>.</p>
<p>Let’s see an example. <span class="citation"><a href="#ref-lathrop2013madison" role="doc-biblioref">Lathrop</a> (<a href="#ref-lathrop2013madison" role="doc-biblioref">2013</a>)</span> directed a long-term sampling program, from 1976 to 1994, on the population of zooplankton at the four Yahara River chain of lakes (Mendota, Monona, Waubesa, and Kegonsa) in the state of Wisconsin, USA. <span class="citation"><a href="#ref-pedersen2019hierarchical" role="doc-biblioref">Pedersen et al.</a> (<a href="#ref-pedersen2019hierarchical" role="doc-biblioref">2019</a>)</span> analyzed a processed version of this data using <em>Hierarchical Generalized Additive Models</em> (HGAMs) (more on this later), and the code in R used for the analysis can be found in the <a href="https://doi.org/10.7717/peerj.6876/supp-1">Supplemental Information</a> section of the paper. We are going to reproduce this analysis to show the main concepts about GAMs.</p>
<p>The data set consist on measurements of the population density of 8 zooplankton taxa in the aforementioned lakes taken roughly in a biweekly schedule, although, depending on the season or weather conditions, the sampling frequency varied. The day of the week of the measurement was recorded, as well as the year. Our aim is to build a model to infer population density of a taxon at a certain day of the year in the Mendota lake. Accordingly, the population density is our response variable, and the taxon and the day of the year are our predictor variables. The sample distribution of the population density has a very right skewed distribution, with most of its density close to zero. For instance, a population density can not be less than zero. For this reason, we are a going to model the population density using a Gamma distribution, and use a <em>Generalized Linear Model</em> (GLM) to build a regression linear model on the log-mean of the population density. We are going to shed light on this later, our porpuse here is only to show some graphical examples.</p>
<p>First, let’s keep things simple and analyze the association between the population density and the day of the year for a particular taxon in lake Mendota. Let’s select the <em>D. thomasi</em> taxon and build a scatterplot with the days of year. For practical reasons, we are going to plot the population density in a base 10 logarithmic scale.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="intro.html#cb1-1" aria-hidden="true" tabindex="-1"></a>filepath <span class="ot">&lt;-</span> <span class="fu">path</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;zooplankton.csv&quot;</span>)</span>
<span id="cb1-2"><a href="intro.html#cb1-2" aria-hidden="true" tabindex="-1"></a>zooplankton <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(filepath)</span>
<span id="cb1-3"><a href="intro.html#cb1-3" aria-hidden="true" tabindex="-1"></a>zoo_example <span class="ot">&lt;-</span> <span class="fu">filter</span>(zooplankton, taxon <span class="sc">==</span> <span class="st">&quot;D. thomasi&quot;</span>, lake <span class="sc">==</span> <span class="st">&quot;Mendota&quot;</span>)</span>
<span id="cb1-4"><a href="intro.html#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="intro.html#cb1-5" aria-hidden="true" tabindex="-1"></a>plt_thomasi <span class="ot">&lt;-</span> </span>
<span id="cb1-6"><a href="intro.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  zoo_example <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="intro.html#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> density_adj)) <span class="sc">+</span></span>
<span id="cb1-8"><a href="intro.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="intro.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>),</span>
<span id="cb1-10"><a href="intro.html#cb1-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0.1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;100&quot;</span>, <span class="st">&quot;1000&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1-11"><a href="intro.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Day of year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Population density&quot;</span>) </span>
<span id="cb1-12"><a href="intro.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="intro.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_thomasi)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-simple"></span>
<img src="intro-to-gam_files/figure-html/scatter-simple-1.png" alt="Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake." width="672" />
<p class="caption">
Figure 1.1: Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake.
</p>
</div>
<p>In Figure <a href="intro.html#fig:scatter-simple">1.1</a> we can distinguish a pattern in the population density throughout the days, but it is clearly kind of difficult to tell its form. One thing is for sure, it isn’t a linear association. Consequently, a (generalized) linear regression model would be inadequate. To check this, let’s plot the linear regression fitted line.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> zoo_example<span class="sc">$</span>day</span>
<span id="cb2-2"><a href="intro.html#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> zoo_example<span class="sc">$</span>density_adj</span>
<span id="cb2-3"><a href="intro.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="intro.html#cb2-4" aria-hidden="true" tabindex="-1"></a>glm_linear <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb2-5"><a href="intro.html#cb2-5" aria-hidden="true" tabindex="-1"></a>pred_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_linear, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2-6"><a href="intro.html#cb2-6" aria-hidden="true" tabindex="-1"></a>dat_linear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">linear =</span> pred_linear)</span>
<span id="cb2-7"><a href="intro.html#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="intro.html#cb2-8" aria-hidden="true" tabindex="-1"></a>plt_glm_linear <span class="ot">&lt;-</span> </span>
<span id="cb2-9"><a href="intro.html#cb2-9" aria-hidden="true" tabindex="-1"></a>  plt_thomasi <span class="sc">+</span></span>
<span id="cb2-10"><a href="intro.html#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_linear, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> linear, <span class="at">colour =</span> <span class="st">&quot;linear&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2-11"><a href="intro.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_npg</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="intro.html#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb2-13"><a href="intro.html#cb2-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-14"><a href="intro.html#cb2-14" aria-hidden="true" tabindex="-1"></a>plt_glm_linear</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-linear"></span>
<img src="intro-to-gam_files/figure-html/scatter-linear-1.png" alt="Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake showing the linear regression fitted line." width="672" />
<p class="caption">
Figure 1.2: Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake showing the linear regression fitted line.
</p>
</div>
<p>From <a href="intro.html#fig:scatter-linear">1.2</a> we can check that the fitted GLM line definitely does not capture the association of the population density and the days of the year. As we stated in the initial paragraph, we need to find a function <span class="math inline">\(\hat{f}\)</span> to be able to predict the response variable. But, how do we specify this function so it accurately capture the association between the variables? For instance, in the GLM, it is assumed a linear association between the log-mean of the response and the predictor. This is a very restrictive form, but certainly useful in a variety of applications. However, we now for sure it won’t be useful for our analysis. We could try polynomial regression. Let’s plot a second degree and a third degree polynomial regression fitted curve, together with the linear regression fitted line .</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="intro.html#cb3-1" aria-hidden="true" tabindex="-1"></a>glm_poly2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb3-2"><a href="intro.html#cb3-2" aria-hidden="true" tabindex="-1"></a>pred_poly2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_poly2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb3-3"><a href="intro.html#cb3-3" aria-hidden="true" tabindex="-1"></a>glm_poly3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb3-4"><a href="intro.html#cb3-4" aria-hidden="true" tabindex="-1"></a>pred_poly3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_poly3, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb3-5"><a href="intro.html#cb3-5" aria-hidden="true" tabindex="-1"></a>dat_poly <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, pred_linear, pred_poly2, pred_poly3)</span>
<span id="cb3-6"><a href="intro.html#cb3-6" aria-hidden="true" tabindex="-1"></a>dat_poly_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb3-7"><a href="intro.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  dat_poly,</span>
<span id="cb3-8"><a href="intro.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>x,</span>
<span id="cb3-9"><a href="intro.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb3-10"><a href="intro.html#cb3-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-11"><a href="intro.html#cb3-11" aria-hidden="true" tabindex="-1"></a>dat_poly_long<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_poly_long<span class="sc">$</span>model, </span>
<span id="cb3-12"><a href="intro.html#cb3-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pred_linear&quot;</span>, <span class="st">&quot;pred_poly2&quot;</span>, </span>
<span id="cb3-13"><a href="intro.html#cb3-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;pred_poly3&quot;</span>), </span>
<span id="cb3-14"><a href="intro.html#cb3-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;linear&quot;</span>, <span class="st">&quot;poly(2)&quot;</span>, <span class="st">&quot;poly(3)&quot;</span>))</span>
<span id="cb3-15"><a href="intro.html#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="intro.html#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="intro.html#cb3-17" aria-hidden="true" tabindex="-1"></a>plt_glm_poly <span class="ot">&lt;-</span> </span>
<span id="cb3-18"><a href="intro.html#cb3-18" aria-hidden="true" tabindex="-1"></a>  plt_thomasi <span class="sc">+</span></span>
<span id="cb3-19"><a href="intro.html#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_poly_long, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">col =</span> model)) <span class="sc">+</span></span>
<span id="cb3-20"><a href="intro.html#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_npg</span>() <span class="sc">+</span></span>
<span id="cb3-21"><a href="intro.html#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb3-22"><a href="intro.html#cb3-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-23"><a href="intro.html#cb3-23" aria-hidden="true" tabindex="-1"></a>plt_glm_poly</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-poly"></span>
<img src="intro-to-gam_files/figure-html/scatter-poly-1.png" alt="Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake showing the linear regression fitted line and the second and third degree polynomial regression fitted curves." width="672" />
<p class="caption">
Figure 1.3: Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake showing the linear regression fitted line and the second and third degree polynomial regression fitted curves.
</p>
</div>
<p>We see from Figure <a href="intro.html#fig:scatter-poly">1.3</a> that the third degree polynomial offers a good fit to the data. The disadvantage is that it is still a linear regression model. The only thing that changes is that the response is regressed over some transformation of the predictors, in this case, the n-th degree polynomial. This is certainly a good trick. But, what if we want to model more complex non-linear associations? We need a more flexible approach. <em>Generalized Additive Models</em> (GAMs) allow us to build very flexible models by using <em>smooth functions</em> over the predictors that can take a variety of forms and structures. Let’s see them in action. We are going to add a GAM fitted smooth curve to the plot.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="intro.html#cb4-1" aria-hidden="true" tabindex="-1"></a>gam_smooth <span class="ot">&lt;-</span> <span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb4-2"><a href="intro.html#cb4-2" aria-hidden="true" tabindex="-1"></a>pred_smooth <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_smooth, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-3"><a href="intro.html#cb4-3" aria-hidden="true" tabindex="-1"></a>dat_smooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dat_poly, pred_smooth)</span>
<span id="cb4-4"><a href="intro.html#cb4-4" aria-hidden="true" tabindex="-1"></a>dat_smooth_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb4-5"><a href="intro.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  dat_smooth,</span>
<span id="cb4-6"><a href="intro.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>x,</span>
<span id="cb4-7"><a href="intro.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb4-8"><a href="intro.html#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="intro.html#cb4-9" aria-hidden="true" tabindex="-1"></a>dat_smooth_long<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_smooth_long<span class="sc">$</span>model, </span>
<span id="cb4-10"><a href="intro.html#cb4-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pred_linear&quot;</span>, <span class="st">&quot;pred_poly2&quot;</span>, </span>
<span id="cb4-11"><a href="intro.html#cb4-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;pred_poly3&quot;</span>, <span class="st">&quot;pred_smooth&quot;</span>), </span>
<span id="cb4-12"><a href="intro.html#cb4-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;linear&quot;</span>, <span class="st">&quot;poly(2)&quot;</span>, <span class="st">&quot;poly(3)&quot;</span>, </span>
<span id="cb4-13"><a href="intro.html#cb4-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;smooth&quot;</span>))</span>
<span id="cb4-14"><a href="intro.html#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="intro.html#cb4-15" aria-hidden="true" tabindex="-1"></a>plt_gam_smooth <span class="ot">&lt;-</span> </span>
<span id="cb4-16"><a href="intro.html#cb4-16" aria-hidden="true" tabindex="-1"></a>  plt_thomasi <span class="sc">+</span></span>
<span id="cb4-17"><a href="intro.html#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_smooth_long, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">col =</span> model)) <span class="sc">+</span></span>
<span id="cb4-18"><a href="intro.html#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_npg</span>() <span class="sc">+</span></span>
<span id="cb4-19"><a href="intro.html#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb4-20"><a href="intro.html#cb4-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-21"><a href="intro.html#cb4-21" aria-hidden="true" tabindex="-1"></a>plt_gam_smooth</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter-gam"></span>
<img src="intro-to-gam_files/figure-html/scatter-gam-1.png" alt="Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake showing a GAM fitted curve, second and third degree polynomial regression fitted curves and the LOESS fitted curve." width="672" />
<p class="caption">
Figure 1.4: Scatterplot of the population density and the day of the day for the D. thomasi taxon in Mendota lake showing a GAM fitted curve, second and third degree polynomial regression fitted curves and the LOESS fitted curve.
</p>
</div>
<p>One highlight from Figure <a href="intro.html#fig:scatter-gam">1.4</a> is that the GAM fitted curve is more flexible than the other curves. Unlike the polynomial regression curves, we didn’t have to specify a certain degree or parameter to generate the curve. This is because the smooth curve is built non-parametrically. Another important detail is that the GAM fitted curve does not overfit the data points for the first 100 days, nor for the last 100 days, which is when the pattern is less obvious. This is an indicator that the GAM offers better generalization.</p>
<p>Before diving to the GAMs specifics, I guess you may be wondering why we care much about finding a good curve or function to specify the associations in the data. Do we really need to bother about this? We could just run a black-box algorithm, like a random forest, and get (mostly certainly) a good prediction accuracy on the population density. For this matter, I believe that a better question would be: when do have to worry about knowing the form of the function <span class="math inline">\(\hat{f}\)</span>? Let’s discuss that in the next section.</p>

</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lathrop2013madison" class="csl-entry">
Lathrop, Richard. 2013. <span>“Madison Wisonsin Lakes Zooplankton 1976-1994.”</span>
</div>
<div id="ref-pedersen2019hierarchical" class="csl-entry">
Pedersen, Eric J, David L Miller, Gavin L Simpson, and Noam Ross. 2019. <span>“Hierarchical Generalized Additive Models in Ecology: An Introduction with Mgcv.”</span> <em>PeerJ</em> 7: e6876.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inter-flex.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro-to-gam.pdf", "intro-to-gam.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
